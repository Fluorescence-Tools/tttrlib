<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tttrlib: /Users/tpeulen/development/fluorescence-tools/tttrlib/include/correlate.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tttrlib
   &#160;<span id="projectnumber">0.0.13</span>
   </div>
   <div id="projectbrief">A tttr library for single-molecule and imaging data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">correlate.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>File containing example of doxygen usage for quick reference.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstdio&gt;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;list&gt;</code><br />
<code>#include &lt;iterator&gt;</code><br />
<code>#include &lt;functional&gt;</code><br />
<code>#include &lt;numeric&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &lt;climits&gt;</code><br />
</div>
<p><a href="correlate_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_correlator.html">Correlator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa27083c37224da35557ece07b1166b8e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correlate_8h.html#aa27083c37224da35557ece07b1166b8e">normalize_correlation</a> (double np1, uint64_t dt1, double np2, uint64_t dt2, std::vector&lt; unsigned long long &gt; &amp;x_axis, std::vector&lt; double &gt; &amp;corr, size_t n_bins)</td></tr>
<tr class="separator:aa27083c37224da35557ece07b1166b8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05e3bd27257b65b0d7ddb939bfe893f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correlate_8h.html#a05e3bd27257b65b0d7ddb939bfe893f8">make_fine_times</a> (unsigned long long *t, unsigned int n_times, unsigned int *tac, unsigned int n_tac)</td></tr>
<tr class="separator:a05e3bd27257b65b0d7ddb939bfe893f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee529d65974dcd19bc1bd9e88e53f528"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correlate_8h.html#aee529d65974dcd19bc1bd9e88e53f528">correlate</a> (size_t start_1, size_t end_1, size_t start_2, size_t end_2, size_t i_casc, size_t n_bins, std::vector&lt; unsigned long long &gt; &amp;taus, std::vector&lt; double &gt; &amp;corr, const unsigned long long *t1, const double *w1, size_t nt1, const unsigned long long *t2, const double *w2, size_t nt2)</td></tr>
<tr class="separator:aee529d65974dcd19bc1bd9e88e53f528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dddd7ef2ed085b6788c321adc5457ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="correlate_8h.html#a6dddd7ef2ed085b6788c321adc5457ca">coarsen</a> (unsigned long long *t, double *w, size_t nt)</td></tr>
<tr class="separator:a6dddd7ef2ed085b6788c321adc5457ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File containing example of doxygen usage for quick reference. </p>
<dl class="section author"><dt>Author</dt><dd>Thomas-Otavio Peulen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>20 Feb 2019 Here typically goes a more extensive explanation of what the header defines. Doxygens tags are words preceeded by either a backslash \ or by an at symbol @. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a href="http://www.stack.nl/~dimitri/doxygen/docblocks.html">http://www.stack.nl/~dimitri/doxygen/docblocks.html</a> </dd>
<dd>
<a href="http://www.stack.nl/~dimitri/doxygen/commands.html">http://www.stack.nl/~dimitri/doxygen/commands.html</a> </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a6dddd7ef2ed085b6788c321adc5457ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dddd7ef2ed085b6788c321adc5457ca">&#9670;&nbsp;</a></span>coarsen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void coarsen </td>
          <td>(</td>
          <td class="paramtype">unsigned long long *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Coarsens the time events</p>
<p>This function coarsens a set of time events by dividing the times by two. In case two consecutive time events in the array have the same time, the weights of the two events are added to the following weight element and the value of the previous weight is set to zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>A vector of the time events of the first channel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w</td><td>A vector of weights for the time events of the first channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>The number of time events in the first channel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aee529d65974dcd19bc1bd9e88e53f528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee529d65974dcd19bc1bd9e88e53f528">&#9670;&nbsp;</a></span>correlate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void correlate </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>start_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>end_1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>start_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>end_2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i_casc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_bins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned long long &gt; &amp;&#160;</td>
          <td class="paramname"><em>taus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long long *&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>w1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long long *&#160;</td>
          <td class="paramname"><em>t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>w2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>nt2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculates the cross-correlation between two arrays containing time events.</p>
<p>Cross-correlates two weighted arrays of events using an approach that utilizes a linear spacing of the bins within a cascade and a logarithmic spacing of the cascades. The function works inplace on the input times, i.e, during the correlation the values of the input times and weights are changed to coarsen the times and weights for every correlation cascade.</p>
<p>The start position parameters</p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">start_1</td><td>and</td></tr>
    <tr><td class="paramname">start_2</td><td>and the end position parameters</td></tr>
    <tr><td class="paramname">end_1</td><td>and</td></tr>
    <tr><td class="paramname">end_1</td><td>define which part of the time array of the first and second correlation channel are used for the correlation analysis.</td></tr>
  </table>
  </dd>
</dl>
<p>The correlation algorithm combines approaches of the following papers:</p>
<ul>
<li>Fast calculation of fluorescence correlation data with asynchronous time-correlated single-photon counting, Michael Wahl, Ingo Gregor, Matthias Patting, Joerg Enderlein, Optics Express Vol. 11, No. 26, p. 3383</li>
<li>Fast, flexible algorithm for calculating photon correlations, Ted A. Laurence, Samantha Fore, Thomas Huser, Optics Express Vol. 31 No. 6, p.829</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">start_1</td><td>The start position on the time event array of the first channel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end_1</td><td>The end position on the time event array of the first channel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">start_2</td><td>The start position on the time event array of the second channel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">end_2</td><td>The end position on the time event array of the second channel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">i_casc</td><td>The number of the current cascade </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_bins</td><td>The number of bins per cascase </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">taus</td><td>A vector containing the correlation times of all cascades </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">corr</td><td>A vector to that the correlation is written by the function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t1</td><td>A vector of the time events of the first channel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w1</td><td>A vector of weights for the time events of the first channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nt1</td><td>The number of time events in the first channel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t2</td><td>A vector of the time events of the second channel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">w2</td><td>A vector of weights for the time events of the second channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nt2</td><td>The number of time events in the second channel </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a05e3bd27257b65b0d7ddb939bfe893f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05e3bd27257b65b0d7ddb939bfe893f8">&#9670;&nbsp;</a></span>make_fine_times()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void make_fine_times </td>
          <td>(</td>
          <td class="paramtype">unsigned long long *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_times</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>tac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>n_tac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Changes the time events by adding the micro time to the macro time</p>
<p>Changes the time events by adding the micro time to the macro time. The micro times should match the macro time, i.e., the length of the micro time array should be the at least the same length as the macro time array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">t</td><td>An array containing the time events (macro times) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_times</td><td>The number of macro times. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tac</td><td>An array containing the micro times of the corresponding macro times </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tac</td><td>The number of micro time channels (TAC channels) </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aa27083c37224da35557ece07b1166b8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa27083c37224da35557ece07b1166b8e">&#9670;&nbsp;</a></span>normalize_correlation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normalize_correlation </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>np1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>dt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>np2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>dt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned long long &gt; &amp;&#160;</td>
          <td class="paramname"><em>x_axis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>corr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_bins</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Normalizes a correlation curve.</p>
<p>This normalization applied to correlation curves that were calculated using a linear/logrithmic binning as described in</p>
<ul>
<li>Fast calculation of fluorescence correlation data with asynchronous time-correlated single-photon counting, Michael Wahl, Ingo Gregor, Matthias Patting, Joerg Enderlein, Optics Express Vol. 11, No. 26, p. 3383</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">np1</td><td>The sum of the weights in the first correlation channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt1</td><td>The time difference between the first event and the last event in the first correlation channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">np2</td><td>The sum of the weights in the second correlation channel </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt2</td><td>The time difference between the first event and the last event in the second correlation channel </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x_axis</td><td>The x-axis of the correlation </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">corr</td><td>The array that contains the original correlation that is modified in place. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_bins</td><td>The number of bins per cascade of the correlation </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
