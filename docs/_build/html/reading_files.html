
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>TTTR objects &#8212; tttrlib  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Compilation" href="compilation.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="tttr-objects">
<h1>TTTR objects<a class="headerlink" href="#tttr-objects" title="Permalink to this headline">¶</a></h1>
<div class="section" id="anatomy">
<h2>Anatomy<a class="headerlink" href="#anatomy" title="Permalink to this headline">¶</a></h2>
<p>The library tttrlib facilitates the work with files containing time-tagged time resolved photon streams by providing
a vendor independent C++ application programming interface (API) for TTTR files that is wrapped by <a class="reference external" href="http://swig.org/">SWIG</a>
(Simplified Wrapper and Interface Generator) for common scripting languages as Python as target languages and non-scripting
languages such as C# and Java including Octave, Scilab and R. This way, the information provided by the TTTR files
can be conveniently accessed without the need of converting the files to alternative vendor independent exchange
file formats as <a class="reference external" href="http://photon-hdf5.github.io/">Photon-HDF</a>.</p>
<p>Common in all TTTR file formats is that the photon data is stored as a stream of events. Every event contains
information on the</p>
<blockquote>
<div><ol class="arabic simple">
<li>Macro time</li>
<li>Micro time</li>
<li>Channel number</li>
<li>Event type</li>
</ol>
</div></blockquote>
<p>The macro time counts the number of clock cycles since the start of the experiment. In TCSPC experiments the
macro time is typically the number of excitation sync pulses of the laser exciting the sample. In continuous wave FCS
experiments the macro time is often the number of clock cycles of an external clock. In time-correlated single
photon counting (TCSPC) experiments, the micro time is usually the time when a photon was detected since the
last excitation laser pulse (macro time). The channel number encodes the detector that detected the event (the photon).
The event type is a special identifier that informs whether the registered event is a photon or an other event
(like a line marker in confocal laser scanning microscopy).To save storage space and band-width most TTTR formats
do not provide the macro time directly. Typically, instead of directly providing the macro time, the number of
events since the last detected event are counted.</p>
<p>For convenience, tttrlib provides a unified way of accessing the TTTR data irrespectively of the vendor data format.
In memory the TTTR data are handled by tttrlib as follows:
conda install conda-build
conda build conda-recipe</p>
<blockquote>
<div><ol class="arabic simple">
<li>Macro time - 64 bit unsigned integer</li>
<li>Micro time - 32 bit unsigned integer</li>
<li>Channel number - 16 bit integer</li>
<li>Event type - 16 bit integer</li>
</ol>
</div></blockquote>
<p>TTTR files are handled by creating TTTR objects that contain the TTTR data of the files. The data contained in the
files can be accessed by the methods provided by the TTTR class. Opening and and accessing the information contained
in TTTR files is demonstrated by the Python code examples shown below.</p>
<p>Attention: The macro time <em>depends</em> on the specific instrument settings.</p>
<div class="section" id="tttr-objects-based-on-files">
<h3>TTTR objects based on files<a class="headerlink" href="#tttr-objects-based-on-files" title="Permalink to this headline">¶</a></h3>
<p>In Python, first, the tttrlib module needs to be imported. Next, a TTTR object needs to be created. When creating a
new TTTR object, the file name and the file type can be passed to the object’s constructor. If a TTTR object is
created this way, by default, the data contained in the TTTR file is read into the TTTR object. The TTTR file type
is either specified by a number or by passing a string to the TTTR object’s constructor.</p>
<span id="supported-file-types"></span><table border="1" class="colwidths-auto docutils" id="id2">
<caption><span class="caption-text">Table of supported file types and corresponding identifiers</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File type</th>
<th class="head">Number</th>
<th class="head">Identifier</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>PicoQuant, PTU
PicoQuant, HT3
Becker&amp;Hickl, SPC130
Becker&amp;Hickl, SPC630-256
Becker&amp;Hickl, SPC630-4096
Photon-HDF5</td>
<td>0
1
2
3
4
5</td>
<td>‘PTU’
‘HT3’
‘SPC-130’
‘SPC-630-256’
‘SPC-630-4096’
‘PHOTON-HDF5’</td>
</tr>
</tbody>
</table>
<p>The two different approaches of initializing TTTR objects. A TTTR object that contains the data in a TTTR file can
be initialized by the filename and the data type as specified in above (see <a class="reference internal" href="#supported-file-types"><span class="std std-ref">Table of supported file types and corresponding identifiers</span></a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">ptu</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/PQ/PTU/PQ_PTU_HH_T3.ptu&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ht3</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/PQ/HT3/01.ht3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">spc132</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">spc600_256</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC630_256.spc&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ht3</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/PQ/HT3/01.ht3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">hdf5</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/HDF/PHOTON-HDF.hdf5&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively, TTTR objects are initialized by the filename and the file type identifier as displayed in
the table above (see <a class="reference internal" href="#supported-file-types"><span class="std std-ref">Table of supported file types and corresponding identifiers</span></a>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">ptu</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/PQ/PTU/PQ_PTU_HH_T3.ptu&#39;</span><span class="p">,</span> <span class="s1">&#39;PTU&#39;</span><span class="p">)</span>
<span class="n">ht3</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/PQ/HT3/01.ht3&#39;</span><span class="p">,</span> <span class="s1">&#39;HT3&#39;</span><span class="p">)</span>
<span class="n">spc132</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-132&#39;</span><span class="p">)</span>
<span class="n">spc600_256</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC630_256.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-630-256&#39;</span><span class="p">)</span>
<span class="n">photon_hdf5</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/HDF/1a_1b_Mix.hdf5&#39;</span><span class="p">,</span> <span class="s1">&#39;PHOTON-HDF5&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A TTTR object provides four getter methods to access the data contained in the associated file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-132&#39;</span><span class="p">)</span>
<span class="n">macro_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_macro_time</span><span class="p">()</span>
<span class="n">micro_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_micro_time</span><span class="p">()</span>
<span class="n">channel</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_channel</span><span class="p">()</span>
<span class="n">event_type</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_event_type</span><span class="p">()</span>
</pre></div>
</div>
<p>In Python, the getter methods return <a class="reference external" href="http://www.numpy.org/">NumPy</a> arrays.</p>
</div>
<div class="section" id="tttr-objects-based-on-selections">
<h3>TTTR objects based on selections<a class="headerlink" href="#tttr-objects-based-on-selections" title="Permalink to this headline">¶</a></h3>
<p>Based on an existing TTTR object and a selection a new TTTR object can be created. That only contains the selected
elements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-130&#39;</span><span class="p">)</span>
<span class="n">ch_indeces</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_selection_by_channel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">ph</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ch_indeces</span><span class="p">)</span>
</pre></div>
</div>
<p>The new TTTR object contains a copy of the relevant events.</p>
</div>
</div>
<div class="section" id="subsets">
<h2>Subsets<a class="headerlink" href="#subsets" title="Permalink to this headline">¶</a></h2>
<p>Beyond the the array processing capabilities either provided by the high-level programming language or an library
like <a class="reference external" href="http://www.numpy.org/">NumPy</a>, <code class="docutils literal notranslate"><span class="pre">tttrlib</span></code> offers a set of functions and methods to select a subset of the
data contained in a TTTR file. There are two options to get selection for a subset of the data</p>
<blockquote>
<div><ol class="arabic simple">
<li>By <em>ranges</em></li>
<li>By <em>selection</em></li>
</ol>
</div></blockquote>
<p><em>Ranges</em> are lists of subsequential tuples marking the beginning and the end of a range. <em>Selections</em> are list
of integers, where the integers refer to the indices of the event stream that was selected.</p>
<p>For instance, for the sequence of time events displayed in the following table</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>index</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>4</td>
<td>5</td>
<td>6</td>
<td>7</td>
<td>8</td>
<td>9</td>
</tr>
<tr class="row-even"><td>time</td>
<td>1</td>
<td>12</td>
<td>13</td>
<td>14</td>
<td>15</td>
<td>18</td>
<td>20</td>
<td>23</td>
<td>30</td>
<td>32</td>
</tr>
</tbody>
</table>
<p>the selection (1, 3, 5, 7) yields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">23</span>
</pre></div>
</div>
<p>and the ranges (0, 2) and (7, 9) yield:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">),</span> <span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</pre></div>
</div>
<p>Depending on the specific application either ranges or selections are more useful. For instance, single molecule bursts
are usually defined by <em>ranges</em>, while detection channels are usually selected by <em>selections</em>.</p>
<div class="section" id="selections">
<h3>Selections<a class="headerlink" href="#selections" title="Permalink to this headline">¶</a></h3>
<div class="section" id="channels">
<h4>Channels<a class="headerlink" href="#channels" title="Permalink to this headline">¶</a></h4>
<p>A very typical use case in TCSPC experiments (either in fluorescence lifetime microscopy (FLIM) or multiparameteric
fluorescence detection (MFD)) is to select a subset of the registered events based on the detection channel. The
experimental example data provided by the file <code class="docutils literal notranslate"><span class="pre">./examples/BH/BH_SPC132.spc</span></code> four detectors were used to register
the fluorescence signal with two polarizations in a ‘green’ and ‘red’ spectral range. In the example file the detector
numbers for the green fluorescence were (0, 8) and (1, 9) for the red detection window.</p>
<p>The method ‘get_selection_by_channel’ provides an array that contains the indices of the events when a the channel
equals the channel number of the provided arguments. To obtain the indices where the channel number. In the example
below the indices of the green (channel = 0 or channel = 8) and the indeces of the red (channel = 1 or channel = 9)
are saved in the variables <code class="docutils literal notranslate"><span class="pre">green_indices</span></code>  and <code class="docutils literal notranslate"><span class="pre">red_indices</span></code>, respectively.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tttrlib</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-132&#39;</span><span class="p">)</span>

<span class="n">green_indices</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_selection_by_channel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">]))</span>
<span class="n">red_indices</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_selection_by_channel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">]))</span>
</pre></div>
</div>
<p>This examples needs to be adapted to the channel assignment dependent on the actual experimental setup.</p>
</div>
<div class="section" id="count-rate">
<h4>Count rate<a class="headerlink" href="#count-rate" title="Permalink to this headline">¶</a></h4>
<p>Another very common selection is to select certain events out of the photon stream based on the count rate. The count
rate is determined by the number of detected events within a given time window. The selection by the method
<code class="docutils literal notranslate"><span class="pre">get_selection_by_count_rate</span></code> returns all indices where less photons were detected within a specified time window.
The time window is given by the number of macro time steps.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-132&#39;</span><span class="p">)</span>
<span class="n">cr_selection</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_selection_by_count_rate</span><span class="p">(</span><span class="mi">1200000</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example shown above, the time window is 1200000 and 30 is the maximum number of photons within that is
permitted in a time window.</p>
</div>
</div>
<div class="section" id="ranges">
<h3>Ranges<a class="headerlink" href="#ranges" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ranges-by-time-windows">
<h4>Ranges by time-windows<a class="headerlink" href="#ranges-by-time-windows" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tttrlib</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tttrlib</span><span class="o">.</span><span class="n">TTTR</span><span class="p">(</span><span class="s1">&#39;./examples/BH/BH_SPC132.spc&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC-132&#39;</span><span class="p">)</span>
<span class="n">cr_selection</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_selection_by_count_rate</span><span class="p">(</span><span class="mi">1200000</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<p>ranges_by_time_window</p>
</div>
<div class="section" id="frames">
<h4>Frames<a class="headerlink" href="#frames" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">tttrlib</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Compilation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">TTTR objects</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="compilation.html" title="previous chapter">Compilation</a></li>
      <li>Next: <a href="examples.html" title="next chapter">Examples</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Thomas-Otavio Peulen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/reading_files.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>